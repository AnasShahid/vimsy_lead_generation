<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Website Health Report — {{domain}}</title>
  <style>
    @page {
      size: A4;
      margin: 0;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif;
      font-size: 11pt;
      line-height: 1.6;
      color: #1f2937;
      background: #fff;
    }

    .page {
      padding: 20mm 15mm;
      page-break-after: always;
      min-height: 100vh;
      position: relative;
    }

    .page:last-child {
      page-break-after: auto;
    }

    /* Cover Page */
    .cover {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      background: linear-gradient(135deg, {{branding.primary_color}}08 0%, {{branding.primary_color}}15 100%);
    }

    .cover-logo {
      max-height: 60px;
      margin-bottom: 40px;
    }

    .cover-logo-text {
      font-size: 28pt;
      font-weight: 700;
      color: {{branding.primary_color}};
      margin-bottom: 40px;
      letter-spacing: -0.5px;
    }

    .cover-title {
      font-size: 18pt;
      font-weight: 300;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 3px;
      margin-bottom: 20px;
    }

    .cover-domain {
      font-size: 32pt;
      font-weight: 700;
      color: #111827;
      margin-bottom: 10px;
      word-break: break-all;
    }

    .cover-company {
      font-size: 14pt;
      color: #6b7280;
      margin-bottom: 50px;
    }

    .cover-date {
      font-size: 10pt;
      color: #9ca3af;
    }

    .cover-accent {
      width: 80px;
      height: 4px;
      background: {{branding.primary_color}};
      margin: 30px auto;
      border-radius: 2px;
    }

    /* Section Headers */
    .section-header {
      font-size: 16pt;
      font-weight: 700;
      color: {{branding.primary_color}};
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid {{branding.primary_color}}30;
    }

    .section-subheader {
      font-size: 12pt;
      font-weight: 600;
      color: #374151;
      margin-top: 20px;
      margin-bottom: 10px;
    }

    /* Score Display */
    .score-hero {
      text-align: center;
      margin: 30px 0;
    }

    .score-circle {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 140px;
      height: 140px;
      border-radius: 50%;
      border: 6px solid {{score_color health_score}};
      margin-bottom: 15px;
    }

    .score-value {
      font-size: 36pt;
      font-weight: 700;
      color: {{score_color health_score}};
    }

    .score-label {
      font-size: 10pt;
      color: #6b7280;
    }

    .priority-badge {
      display: inline-block;
      padding: 6px 18px;
      border-radius: 20px;
      font-size: 10pt;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #fff;
      background: {{score_color health_score}};
    }

    /* Score Bars */
    .score-bars {
      margin: 25px 0;
    }

    .score-bar-row {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
    }

    .score-bar-label {
      width: 120px;
      font-size: 10pt;
      font-weight: 500;
      color: #4b5563;
    }

    .score-bar-track {
      flex: 1;
      height: 14px;
      background: #f3f4f6;
      border-radius: 7px;
      overflow: hidden;
      margin: 0 12px;
    }

    .score-bar-fill {
      height: 100%;
      border-radius: 7px;
      transition: width 0.3s;
    }

    .score-bar-value {
      width: 50px;
      text-align: right;
      font-size: 10pt;
      font-weight: 600;
      color: #374151;
    }

    /* PSI Grid */
    .psi-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin: 20px 0;
    }

    .psi-card {
      padding: 18px;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      text-align: center;
    }

    .psi-score {
      font-size: 28pt;
      font-weight: 700;
    }

    .psi-label {
      font-size: 9pt;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 4px;
    }

    /* Status Cards */
    .status-card {
      padding: 15px 18px;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .status-label {
      font-size: 10pt;
      color: #6b7280;
    }

    .status-value {
      font-size: 10pt;
      font-weight: 600;
    }

    .status-good { color: #16a34a; }
    .status-warn { color: #ca8a04; }
    .status-bad { color: #dc2626; }
    .status-neutral { color: #6b7280; }

    /* Tables */
    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
      font-size: 9.5pt;
    }

    .data-table th {
      background: #f9fafb;
      padding: 10px 12px;
      text-align: left;
      font-weight: 600;
      color: #374151;
      border-bottom: 2px solid #e5e7eb;
      font-size: 9pt;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    .data-table td {
      padding: 8px 12px;
      border-bottom: 1px solid #f3f4f6;
      color: #4b5563;
    }

    .data-table tr:last-child td {
      border-bottom: none;
    }

    .badge-outdated {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 8pt;
      font-weight: 600;
      background: #fef2f2;
      color: #dc2626;
    }

    /* AI Content */
    .ai-content {
      font-size: 10.5pt;
      line-height: 1.7;
      color: #374151;
    }

    .ai-content p {
      margin-bottom: 12px;
    }

    .ai-content ul, .ai-content ol {
      margin: 10px 0;
      padding-left: 24px;
    }

    .ai-content li {
      margin-bottom: 6px;
    }

    .ai-content strong {
      color: #111827;
    }

    .ai-content h3, .ai-content h4 {
      color: {{branding.primary_color}};
      margin-top: 16px;
      margin-bottom: 8px;
    }

    /* CTA Section */
    .cta-box {
      background: {{branding.primary_color}}08;
      border: 2px solid {{branding.primary_color}}30;
      border-radius: 12px;
      padding: 25px 30px;
      margin: 25px 0;
    }

    .cta-text {
      font-size: 12pt;
      font-weight: 600;
      color: {{branding.primary_color}};
      margin-bottom: 15px;
    }

    .contact-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 15px;
    }

    .contact-item {
      font-size: 9.5pt;
    }

    .contact-label {
      font-size: 8pt;
      color: #9ca3af;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .contact-value {
      font-weight: 600;
      color: #374151;
    }

    /* Disclaimer */
    .disclaimer {
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #e5e7eb;
      font-size: 8.5pt;
      color: #9ca3af;
      line-height: 1.5;
    }

    /* Vuln summary */
    .vuln-summary {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin: 15px 0;
    }

    .vuln-count {
      text-align: center;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
    }

    .vuln-count-value {
      font-size: 20pt;
      font-weight: 700;
    }

    .vuln-count-label {
      font-size: 8pt;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #6b7280;
    }

    /* Security headers */
    .header-check {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 0;
      font-size: 10pt;
    }

    .check-icon {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 10pt;
      font-weight: 700;
    }

    .check-pass {
      background: #dcfce7;
      color: #16a34a;
    }

    .check-fail {
      background: #fef2f2;
      color: #dc2626;
    }

    /* Warning box */
    .warning-box {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 8px;
      padding: 12px 16px;
      margin: 10px 0;
      font-size: 10pt;
      color: #991b1b;
    }
  </style>
</head>
<body>

  <!-- Page 1: Cover -->
  <div class="page cover">
    {{#if branding.logo_url}}
      <img src="{{branding.logo_url}}" alt="{{branding.company_name}}" class="cover-logo" />
    {{else}}
      <div class="cover-logo-text">{{branding.company_name}}</div>
    {{/if}}

    <div class="cover-title">Website Health Report</div>
    <div class="cover-accent"></div>
    <div class="cover-domain">{{domain}}</div>
    {{#if company_name}}
      <div class="cover-company">{{company_name}}</div>
    {{/if}}
    <div class="cover-date">Generated on {{generated_date}}</div>
  </div>

  <!-- Page 2: Executive Summary -->
  <div class="page">
    <h1 class="section-header">Executive Summary</h1>
    <div class="ai-content">
      {{{ai_executive_summary}}}
    </div>
  </div>

  <!-- Page 3: Health Score Overview -->
  <div class="page">
    <h1 class="section-header">Health Score Overview</h1>

    <div class="score-hero">
      <div class="score-circle">
        <span class="score-value">{{health_score}}</span>
      </div>
      <div class="score-label">out of 100</div>
      <div style="margin-top: 12px;">
        <span class="priority-badge">{{priority_classification}}</span>
      </div>
    </div>

    <div class="score-bars">
      <div class="score-bar-row">
        <span class="score-bar-label">Performance</span>
        <div class="score-bar-track">
          <div class="score-bar-fill" style="width: {{score_bar performance_score 30}}%; background: {{score_color_pct performance_score 30}};"></div>
        </div>
        <span class="score-bar-value">{{performance_score}}/30</span>
      </div>
      <div class="score-bar-row">
        <span class="score-bar-label">Security</span>
        <div class="score-bar-track">
          <div class="score-bar-fill" style="width: {{score_bar security_score 30}}%; background: {{score_color_pct security_score 30}};"></div>
        </div>
        <span class="score-bar-value">{{security_score}}/30</span>
      </div>
      <div class="score-bar-row">
        <span class="score-bar-label">SEO</span>
        <div class="score-bar-track">
          <div class="score-bar-fill" style="width: {{score_bar seo_score 20}}%; background: {{score_color_pct seo_score 20}};"></div>
        </div>
        <span class="score-bar-value">{{seo_score}}/20</span>
      </div>
      <div class="score-bar-row">
        <span class="score-bar-label">Availability</span>
        <div class="score-bar-track">
          <div class="score-bar-fill" style="width: {{score_bar availability_score 20}}%; background: {{score_color_pct availability_score 20}};"></div>
        </div>
        <span class="score-bar-value">{{availability_score}}/20</span>
      </div>
    </div>
  </div>

  <!-- Page 4: Performance Details -->
  <div class="page">
    <h1 class="section-header">Performance Details</h1>
    <p style="margin-bottom: 20px; color: #6b7280; font-size: 10pt;">Scores from Google PageSpeed Insights — measuring real-world performance, accessibility, SEO, and best practices.</p>

    <div class="psi-grid">
      <div class="psi-card">
        <div class="psi-score" style="color: {{score_color_100 psi_performance_score}};">{{format_number psi_performance_score}}</div>
        <div class="psi-label">Performance</div>
      </div>
      <div class="psi-card">
        <div class="psi-score" style="color: {{score_color_100 psi_accessibility_score}};">{{format_number psi_accessibility_score}}</div>
        <div class="psi-label">Accessibility</div>
      </div>
      <div class="psi-card">
        <div class="psi-score" style="color: {{score_color_100 psi_seo_score}};">{{format_number psi_seo_score}}</div>
        <div class="psi-label">SEO</div>
      </div>
      <div class="psi-card">
        <div class="psi-score" style="color: {{score_color_100 psi_best_practices_score}};">{{format_number psi_best_practices_score}}</div>
        <div class="psi-label">Best Practices</div>
      </div>
    </div>
  </div>

  <!-- Page 5: Security Analysis -->
  <div class="page">
    <h1 class="section-header">Security Analysis</h1>

    <h2 class="section-subheader">SSL/TLS Certificate</h2>
    <div class="status-card">
      <span class="status-label">SSL Status</span>
      <span class="status-value {{#if ssl_valid}}status-good{{else}}status-bad{{/if}}">
        {{#if ssl_valid}}Valid{{else}}Invalid / Missing{{/if}}
      </span>
    </div>
    {{#if ssl_issuer}}
    <div class="status-card">
      <span class="status-label">Issuer</span>
      <span class="status-value status-neutral">{{ssl_issuer}}</span>
    </div>
    {{/if}}
    {{#if ssl_expiry_date}}
    <div class="status-card">
      <span class="status-label">Expires</span>
      <span class="status-value {{#if_lt ssl_days_until_expiry 30}}status-warn{{else}}status-good{{/if_lt}}">
        {{ssl_expiry_date}} ({{ssl_days_until_expiry}} days)
      </span>
    </div>
    {{/if}}
    {{#if ssl_protocol_version}}
    <div class="status-card">
      <span class="status-label">Protocol</span>
      <span class="status-value status-neutral">{{ssl_protocol_version}}</span>
    </div>
    {{/if}}

    {{#if vulnerabilities_found}}
    <h2 class="section-subheader">Vulnerabilities</h2>
    <div class="status-card">
      <span class="status-label">Total Vulnerabilities Found</span>
      <span class="status-value status-bad">{{vulnerabilities_found}}</span>
    </div>
    {{/if}}
  </div>

  <!-- Page 6: WordPress Health (conditional) -->
  {{#if is_wordpress}}
  <div class="page">
    <h1 class="section-header">WordPress Health</h1>

    <div class="status-card">
      <span class="status-label">WordPress Version</span>
      <span class="status-value {{#if_eq wpscan_wp_version_status 'latest'}}status-good{{else}}status-warn{{/if_eq}}">
        {{or wpscan_wp_version 'Unknown'}} ({{or wpscan_wp_version_status 'Unknown'}})
      </span>
    </div>

    {{#if wpscan_theme}}
    <div class="status-card">
      <span class="status-label">Theme</span>
      <span class="status-value status-neutral">{{wpscan_theme}}{{#if wpscan_theme_version}} v{{wpscan_theme_version}}{{/if}}</span>
    </div>
    {{/if}}

    {{#if plugins.length}}
    <h2 class="section-subheader">Detected Plugins</h2>
    <table class="data-table">
      <thead>
        <tr>
          <th>Plugin</th>
          <th>Version</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {{#each plugins}}
        <tr>
          <td>{{this.name}}</td>
          <td>{{or this.version '—'}}</td>
          <td>
            {{#if this.outdated}}
              <span class="badge-outdated">Outdated</span>
            {{else}}
              <span class="status-good">OK</span>
            {{/if}}
          </td>
        </tr>
        {{/each}}
      </tbody>
    </table>
    {{/if}}

    {{#if users.length}}
    <div class="warning-box">
      ⚠ {{users.length}} WordPress user(s) were enumerable — this is a security risk.
    </div>
    {{/if}}

    {{#if config_backups.length}}
    <div class="warning-box">
      ⚠ {{config_backups.length}} configuration backup file(s) found exposed on the server.
    </div>
    {{/if}}

    {{#if db_exports.length}}
    <div class="warning-box">
      ⚠ {{db_exports.length}} database export file(s) found exposed on the server.
    </div>
    {{/if}}
  </div>
  {{/if}}

  <!-- Page 7: SEO Overview -->
  <div class="page">
    <h1 class="section-header">SEO Overview</h1>

    <div class="psi-grid" style="grid-template-columns: 1fr;">
      <div class="psi-card" style="text-align: left;">
        <div class="status-card" style="border: none; padding: 0; margin-bottom: 8px;">
          <span class="status-label">SEO Score (PageSpeed)</span>
          <span class="psi-score" style="font-size: 20pt; color: {{score_color_100 psi_seo_score}};">{{format_number psi_seo_score}}/100</span>
        </div>
        <div class="status-card" style="border: none; padding: 0; margin-bottom: 8px;">
          <span class="status-label">Meta Description</span>
          <span class="status-value {{#if meta_description}}status-good{{else}}status-bad{{/if}}">
            {{#if meta_description}}Present{{else}}Missing{{/if}}
          </span>
        </div>
        <div class="status-card" style="border: none; padding: 0;">
          <span class="status-label">Page Title</span>
          <span class="status-value {{#if page_title}}status-good{{else}}status-bad{{/if}}">
            {{#if page_title}}Present{{else}}Missing{{/if}}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Page 8: Recommendations -->
  <div class="page">
    <h1 class="section-header">Recommendations</h1>
    <div class="ai-content">
      {{{ai_recommendations}}}
    </div>
  </div>

  <!-- Page 9: About / CTA -->
  <div class="page">
    <h1 class="section-header">How {{branding.company_name}} Can Help</h1>

    <div class="ai-content">
      {{{ai_pitch}}}
    </div>

    <div class="cta-box">
      <div class="cta-text">{{branding.cta_text}}</div>
      <div class="contact-grid">
        {{#if branding.contact_email}}
        <div class="contact-item">
          <div class="contact-label">Email</div>
          <div class="contact-value">{{branding.contact_email}}</div>
        </div>
        {{/if}}
        {{#if branding.contact_phone}}
        <div class="contact-item">
          <div class="contact-label">Phone</div>
          <div class="contact-value">{{branding.contact_phone}}</div>
        </div>
        {{/if}}
        {{#if branding.contact_website}}
        <div class="contact-item">
          <div class="contact-label">Website</div>
          <div class="contact-value">{{branding.contact_website}}</div>
        </div>
        {{/if}}
      </div>
    </div>

    <!-- Disclaimer -->
    <div class="disclaimer">
      <p>{{branding.disclaimer}}</p>
      <p style="margin-top: 8px;">Report generated on {{generated_date}} by {{branding.company_name}}</p>
    </div>
  </div>

</body>
</html>
